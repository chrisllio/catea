define(["jquery","Class","UiBase","AnimationFrame","Spy","utils","Map","prototype"],function(t,e,n,r,a,s,i){"use strict";var o=new i,d=function(n,r){o.get(n+".class")?r():require([n],function(a){var s=null;if(a.parent&&(s=o.get(a.parent+".class")),a.parent&&!s)d(a.parent,function(){d(n,r)});else{if(a.class){var i={};for(var l in a.methods){var u=a.methods[l];if(!l.startWith("_")&&a.methods.hasOwnProperty(l)&&"function"==typeof u){if(a.class[l])throw new Error("Widget '"+n+"' already has a member named '"+l+"', please rename your method.");i[l]=u}}o.put(n+".class",(s||e).extend(t.extend({},a.class,i))),o.put(n+".methods",i),o.put(n+".settings",a.settings),o.put(n+".defaults",a.defaults)}r()}})};return{register:d,render:function(e,n,r,a){var i=t(e),d=this,l=i.data("__widget_shEll_dAta_keY_");if(l)throw new Error("This node{id:"+i.attr("id")+",name:"+i.attr("name")+",class:"+i.attr("class")+"} cannot be rendered repeatedly.");d.register(n,function(){var d=t.extend({},o.get(n+".defaults"),s.setProperties({},e),r),u=o.get(n+".class"),c=o.get(n+".methods"),f=o.get(n+".settings");new u(e,d,f,n,function(){var t=this;l={execute:function(){if(0!==arguments.length){var t=Array.prototype.slice.call(arguments),e=t.shift();return"string"==typeof e?this[e].apply(this,t):void 0}}};for(var e in c)!e.startWith("_")&&c.hasOwnProperty(e)&&function(e){l[e]=function(){var n=t[e].apply(t,arguments);return n===t?this:n}}(e);i.data("__widget_shEll_dAta_keY_",l);var n="function"==typeof a?a:window[a];n&&n()})})},initialize:function(t,e){},init:function(){t.fn.execute=function(){var e=t(this),n=e.data("__widget_shEll_dAta_keY_");if(n)return n.execute.apply(n,arguments);throw new Error("Can not call 'execute' of a not rendered node {id:"+e.attr("id")+",name:"+e.attr("name")+",class:"+e.attr("class")+"} .")}}}});